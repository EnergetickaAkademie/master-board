; ================================================================================
; Common base configuration for all master boards
; ================================================================================
[env]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
monitor_filters = esp32_exception_decoder

# Remove default sizeâ€‘optimization so we can apply our own level
build_unflags =
    -Os
board_build.f_cpu = 240000000L
# Global build flags (apply -O2 for better TLS / crypto performance, keep debug info dwarf-4)
build_flags =
    -O2
    -DCORE_DEBUG_LEVEL=3
    -DCONFIG_ARDUHAL_LOG_COLORS=1
    #'-DPRODUCTION_SERVER_URL="https://enak.swpelc.eu"'
    -ffunction-sections
    -fdata-sections
    -fno-rtti
    -fno-exceptions
lib_deps = 
    https://github.com/gioblu/PJON.git
    https://github.com/EnergetickaAkademie/ota.git
    https://github.com/EnergetickaAkademie/PeripheralsLib.git
    https://github.com/EnergetickaAkademie/NFC-building-registry.git
    https://github.com/EnergetickaAkademie/ESP-API.git
    ayushsharma82/WebSerial@^1.4.0
    ottowinter/ESPAsyncWebServer-esphome@^3.0.0
    marian-craciunescu/ESP32Ping@^1.7
    https://github.com/igorantolic/ai-esp32-rotary-encoder.git




; Optional: Flash settings for ESP32-S3
board_build.flash_mode = qio
board_build.partitions = default.csv

; ================================================================================
; Individual Master Board Configurations
; ================================================================================

; Master Board 001 - Default configuration
[env:masterboard-001]
extends = env
upload_port = /dev/ttyACM0
monitor_port = /dev/ttyACM0
build_flags = 
    ${env.build_flags}
    -DBOARD_ID=1
    '-DBOARD_NAME="MasterBoard-001"'
    '-DAPI_USERNAME="board1"'
    '-DAPI_PASSWORD="board123"'

; Master Board 002
[env:masterboard-002]
extends = env
upload_port = /dev/ttyACM0  ; Change this for each physical board
monitor_port = /dev/ttyACM0
build_flags = 
    ${env.build_flags}
    -DBOARD_ID=2
    '-DBOARD_NAME="MasterBoard-002"'
    '-DAPI_USERNAME="board2"'
    '-DAPI_PASSWORD="board123"'

; Master Board 003
[env:masterboard-003]
extends = env
upload_port = /dev/ttyACM0  ; Change this for each physical board
monitor_port = /dev/ttyACM0
build_flags = 
    ${env.build_flags}
    -DBOARD_ID=3
    '-DBOARD_NAME="MasterBoard-003"'
    '-DAPI_USERNAME="board3"'
    '-DAPI_PASSWORD="board123"'

; Master Board 004
[env:masterboard-004]
extends = env
upload_port = /dev/ttyACM0  ; Change this for each physical board
monitor_port = /dev/ttyACM0
build_flags = 
    ${env.build_flags}
    -DBOARD_ID=4
    '-DBOARD_NAME="MasterBoard-004"'
    '-DAPI_USERNAME="board4"'
    '-DAPI_PASSWORD="board123"'

; Master Board 005
[env:masterboard-005]
extends = env
upload_port = /dev/ttyACM0  ; Change this for each physical board
monitor_port = /dev/ttyACM0
build_flags = 
    ${env.build_flags}
    -DBOARD_ID=5
    '-DBOARD_NAME="MasterBoard-005"'
    '-DAPI_USERNAME="board5"'
    '-DAPI_PASSWORD="board123"'

; ================================================================================
; Legacy environment for backward compatibility
; ================================================================================
[env:esp32-s3-devkitc-1]
extends = env:masterboard-001